<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>AI-Content-Engine</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-900 text-gray-200 font-sans">

  <!-- HÃ¼ll-Container -->
  <div class="min-h-screen flex flex-col md:flex-row md:items-start md:justify-center gap-8 p-6">

    <!-- â–¸ Eingabe-Spalte (links) -->
    <aside class="md:w-96 w-full bg-gray-800 border border-gray-700 shadow-xl rounded-2xl p-6 space-y-6">

      <!-- Logo & Titel -->
      <div class="text-center space-y-4">
        <img src="assets/logo.png" alt="Logo" class="h-12 mx-auto">
        <h1 class="text-2xl font-extrabold text-indigo-400">AI-Content-Engine</h1>
      </div>

      <!-- Formular -->
      <form id="myForm" class="space-y-4 text-sm">

        <div>
          <label class="block text-gray-400 mb-1">Unternehmensname</label>
          <input name="companyName" required
                 class="w-full bg-gray-700 border-gray-600 rounded px-3 py-2 focus:ring-2 focus:ring-indigo-500">
        </div>

        <div>
          <label class="block text-gray-400 mb-1">Website</label>
          <input name="website" type="url" required
                 class="w-full bg-gray-700 border-gray-600 rounded px-3 py-2 focus:ring-2 focus:ring-indigo-500">
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-gray-400 mb-1"># Expos</label>
            <input name="expoCount" type="number" min="1" required
                   class="w-full bg-gray-700 border-gray-600 rounded px-3 py-2 focus:ring-2 focus:ring-indigo-500">
          </div>
          <div>
            <label class="block text-gray-400 mb-1">Branche</label>
            <select name="branche" id="brancheSelect" required
                    class="w-full bg-gray-700 border-gray-600 rounded px-3 py-2 focus:ring-2 focus:ring-indigo-500">
              <option value="">â€“ wÃ¤hlen â€“</option>
            </select>
          </div>
        </div>

        <!-- Multiline-Felder -->
        <div>
          <label class="block text-gray-400 mb-1">Regionen (Komma/;) </label>
          <textarea name="regions" rows="2"
                    class="w-full bg-gray-700 border-gray-600 rounded px-3 py-2 focus:ring-2 focus:ring-indigo-500"
                    placeholder="OÃ–; NÃ–; Wien"></textarea>
        </div>

        <div>
          <label class="block text-gray-400 mb-1">Zielgruppen (Komma/;)</label>
          <textarea name="audiences" rows="2"
                    class="w-full bg-gray-700 border-gray-600 rounded px-3 py-2 focus:ring-2 focus:ring-indigo-500"
                    placeholder="Architekten; BautrÃ¤ger"></textarea>
        </div>

        <div>
          <label class="block text-gray-400 mb-1">Produkte / Dienstleistungen (Komma/;)</label>
          <textarea name="offerings" rows="2"
                    class="w-full bg-gray-700 border-gray-600 rounded px-3 py-2 focus:ring-2 focus:ring-indigo-500"
                    placeholder="Fenster; TÃ¼ren"></textarea>
        </div>

        <!-- Toggle -->
        <div class="flex items-center justify-between">
          <span id="regionalLabel" class="text-gray-300">Ohne Ortsbezug</span>
          <button type="button" id="regionalToggle"
                  class="relative h-6 w-11 rounded-full bg-gray-600 transition-colors"
                  role="switch" aria-checked="false">
            <span class="sr-only">Ortsbezug</span>
            <span aria-hidden="true"
                  class="inline-block h-5 w-5 bg-white rounded-full transform transition translate-x-0"></span>
          </button>
        </div>

        <input type="hidden" name="regional" id="regionalHidden" value="false">

        <button type="submit"
                class="w-full bg-indigo-600 hover:bg-indigo-700 py-2 rounded font-semibold">ðŸš€ Generieren</button>
      </form>
    </aside>

    <!-- â–¸ Ausgabe-Spalte (rechts) -->
    <section class="flex-1 w-full bg-gray-800 border border-gray-700 shadow-xl rounded-2xl p-6 flex flex-col">
      <h2 class="text-lg font-semibold text-indigo-400 mb-4">Antwort der Engine</h2>
      <pre id="responseOutput"
           class="flex-1 bg-gray-900 p-4 rounded overflow-auto text-green-300 font-mono text-xs border border-gray-700"></pre>
    </section>

  </div>

  <!-- JS ---------------------------------------------------------------- -->
  <script>
    /* Toggle-Logik */
    const t = document.getElementById('regionalToggle');
    const l = document.getElementById('regionalLabel');
    const h = document.getElementById('regionalHidden');
    t.addEventListener('click', () => {
      const on = t.getAttribute('aria-checked') === 'true';
      t.setAttribute('aria-checked', !on);
      t.classList.toggle('bg-indigo-600', !on);
      t.classList.toggle('bg-gray-600',   on);
      t.firstElementChild.classList.toggle('translate-x-5', !on);
      t.firstElementChild.classList.toggle('translate-x-0',  on);
      l.textContent = !on ? 'Mit Ortsbezug' : 'Ohne Ortsbezug';
      h.value = !on ? 'true' : 'false';
    });

    /* Branchen-Dropdown laden (Shortlist-JSON) */
    fetch('assets/gmb_categories_de_200.json')
      .then(r => r.json())
      .then(arr => {
        const sel = document.getElementById('brancheSelect');
        arr.forEach(cat => sel.insertAdjacentHTML('beforeend',
          `<option value="${cat}">${cat}</option>`));
      });

    /* Formular absenden */
    document.getElementById('myForm').addEventListener('submit', async e => {
      e.preventDefault();
      const fd   = new FormData(e.target);
      const data = Object.fromEntries(fd.entries());

      ['regions','audiences','offerings'].forEach(k=>{
        data[k] = (data[k]||'').split(/[;,]/).map(x=>x.trim()).filter(Boolean);
      });
      data.expoCount = +data.expoCount || 0;

      const r = await fetch(
        'https://expoya.app.n8n.cloud/webhook/03796224-cbe0-443a-adeb-e91f64514773',
        {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)}
      );
      document.getElementById('responseOutput').textContent =
        JSON.stringify(await r.json(), null, 2);
    });
  </script>
</body>
</html>
